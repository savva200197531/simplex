(function(e){function t(t){for(var a,o,i=t[0],c=t[1],u=t[2],d=0,f=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&f.push(n[o][0]),n[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);l&&l(t);while(f.length)f.shift()();return r.push.apply(r,u||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],a=!0,i=1;i<s.length;i++){var c=s[i];0!==n[c]&&(a=!1)}a&&(r.splice(t--,1),e=o(o.s=s[0]))}return e}var a={},n={app:0},r=[];function o(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=a,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(s,a,function(t){return e[t]}.bind(null,a));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";var a=s("85ec"),n=s.n(a);n.a},"0cb4":function(e,t,s){},"1a84":function(e,t,s){},"32bd":function(e,t,s){"use strict";var a=s("715a"),n=s.n(a);n.a},"3b75":function(e,t,s){"use strict";var a=s("0cb4"),n=s.n(a);n.a},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{attrs:{id:"app"}},[s("router-view")],1)},r=[],o=(s("ac1f"),s("5319"),s("5530")),i=s("2f62"),c=s("8aa5"),u=s.n(c),l={methods:Object(o["a"])({},Object(i["b"])("storage",["handleAuthStateChanged"])),mounted:function(){var e=this;this.handleAuthStateChanged(),u.a.auth().onAuthStateChanged((function(t){t?e.$router.replace("/").catch((function(){})):e.$router.replace("/auth").catch((function(){}))}))}},d=l,f=(s("034f"),s("2877")),p=s("6544"),m=s.n(p),h=s("7496"),g=Object(f["a"])(d,n,r,!1,null,null,null),b=g.exports;m()(g,{VApp:h["a"]});var v=s("f309");a["a"].use(v["a"]);var _=new v["a"]({}),w=s("8c4f"),x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{attrs:{id:"chat"}},[s("v-navigation-drawer",{attrs:{app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[s("display-users")],1),s("v-app-bar",{attrs:{app:"",color:"indigo",dark:""}},[s("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),s("v-toolbar-title",[e._v("Simplex Chat")]),s("v-spacer"),e.userDetails.userId?s("v-btn",{staticClass:"btn mr-4 white--text v-btn--outlined",attrs:{color:"indigo"},on:{click:e.logout}},[s("div",{staticClass:"btn__text"},[e._v(" Logout"),s("br"),s("p",{staticClass:"btn__text-username mb-0"},[e._v(e._s(e.userDetails.name))])])]):e._e()],1),s("v-main",[s("show-messages"),s("send-messages")],1),s("v-footer",{attrs:{color:"indigo",app:""}},[s("span",{staticClass:"white--text"},[e._v('Â© "Simplex", '+e._s((new Date).getFullYear()))])])],1)},y=[],O=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"display-users"}},e._l(e.users,(function(t,a){return s("v-list",{key:a,staticClass:"users-list pb-0",attrs:{dense:""}},[s("v-list-item",{staticClass:"users-list__item"},[s("span",{staticClass:"users-list__avatar"},[e._v(e._s(t.name.charAt(0)))]),e._v(" "+e._s(t.name)+" "),e.userDetails.email===t.email?s("v-icon",{staticClass:"users-list__you mr-1"},[e._v("mdi-account-circle")]):e._e(),s("span",{staticClass:"users-list__text text",class:t.online?"online":"offline"},[e._v(" "+e._s(t.online?"Online":"Offline")+" ")])],1)],1)})),1)},j=[],M={name:"DisplayUsers",computed:Object(o["a"])(Object(o["a"])({},Object(i["d"])("storage",["userDetails"])),Object(i["c"])("storage",["users"]))},k=M,C=(s("c0d3"),s("132d")),D=s("8860"),U=s("da13"),I=Object(f["a"])(k,O,j,!1,null,"0efd4748",null),S=I.exports;m()(I,{VIcon:C["a"],VList:D["a"],VListItem:U["a"]});var V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"chat",staticClass:"chat",attrs:{id:"show-messages"}},e._l(e.messages,(function(t,a){return s("v-list",{key:a,staticClass:"chat__list",class:{owner:t.id===e.userDetails.userId}},[s("v-list-item",{staticClass:"chat__item theme--dark",class:{hidden:!e.showMessages}},[e._v(" "+e._s(t.from)+": "+e._s(t.message)+" ")])],1)})),1)},A=[],T=(s("b64b"),{name:"ShowMessages",data:function(){return{showMessages:!1}},computed:Object(o["a"])({},Object(i["d"])("storage",["userDetails","messages"])),methods:{scrollToBottom:function(){var e=this,t=this.$refs.chat;setTimeout((function(){t.scrollTo(0,t.scrollHeight)}),20),setTimeout((function(){e.showMessages=!0}),1e3)}},watch:{messages:function(e){Object.keys(e).length&&this.scrollToBottom()}},mounted:function(){this.scrollToBottom()}}),$=T,P=(s("bf62"),Object(f["a"])($,V,A,!1,null,"6cbcce68",null)),B=P.exports;m()(P,{VList:D["a"],VListItem:U["a"]});var E=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"actions",attrs:{id:"send-messages"}},[s("v-textarea",{ref:"textField",attrs:{placeholder:"Type your message...",autofocus:"",autocomplete:"false","no-resize":""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMessage(t)}},model:{value:e.message.newMessage,callback:function(t){e.$set(e.message,"newMessage","string"===typeof t?t.trim():t)},expression:"message.newMessage"}}),s("v-btn",{staticClass:"btn mr-4",attrs:{color:"success",disabled:0===e.message.newMessage.length},on:{click:e.sendMessage}},[s("span",{staticClass:"btn-span"},[e._v("Send")])])],1)},L=[],F={name:"SendMessages",data:function(){return{message:{newMessage:"",createdAt:new Date}}},methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])("storage",["firebaseSendMessage","firebaseGetMessages"])),{},{sendMessage:function(){0!==this.message.newMessage.length&&(this.firebaseSendMessage(this.message),this.firebaseGetMessages(),this.clearMessage())},clearMessage:function(){this.message.newMessage="",this.$refs.textField.focus()}}),mounted:function(){this.firebaseGetMessages()}},G=F,N=(s("32bd"),s("8336")),q=s("a844"),z=Object(f["a"])(G,E,L,!1,null,"7d34fed4",null),H=z.exports;m()(z,{VBtn:N["a"],VTextarea:q["a"]});var J={name:"Chat",components:{DisplayUsers:S,ShowMessages:B,SendMessages:H},data:function(){return{drawer:null}},computed:Object(o["a"])({},Object(i["d"])("storage",["userDetails"])),methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])("storage",["logoutUser"])),{},{logout:function(){this.logoutUser()}})},R=J,Y=s("40dc"),Q=s("5bc1"),Z=s("553a"),K=s("f6c4"),W=s("f774"),X=s("2fa4"),ee=s("2a7f"),te=Object(f["a"])(R,x,y,!1,null,"085b72f0",null),se=te.exports;m()(te,{VApp:h["a"],VAppBar:Y["a"],VAppBarNavIcon:Q["a"],VBtn:N["a"],VFooter:Z["a"],VMain:K["a"],VNavigationDrawer:W["a"],VSpacer:X["a"],VToolbarTitle:ee["a"]});var ae=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{attrs:{id:"reg-form"}},[s("v-app-bar",{attrs:{app:"",color:"indigo",dark:""}},[s("v-toolbar-title",[e._v("Simplex Chat")]),s("v-spacer"),e.userDetails.userId?s("v-btn",{staticClass:"btn mr-4 white--text v-btn--outlined",attrs:{color:"indigo"},on:{click:e.logout}},[s("div",{staticClass:"btn__text"},[e._v(" Logout"),s("br"),s("p",{staticClass:"btn__text-username mb-0"},[e._v(e._s(e.userDetails.name))])])]):e._e()],1),s("v-main",[s("v-form",{ref:"form",staticClass:"auth",attrs:{method:"get"},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("h1",{staticClass:"login-title text-lg-center"},[e._v("Please login")]),s("v-text-field",{staticClass:"validate mt-2",attrs:{counter:20,rules:e.nameRules,label:"Name",type:"text",name:"name",required:""},model:{value:e.userInfo.name,callback:function(t){e.$set(e.userInfo,"name",t)},expression:"userInfo.name"}}),s("v-checkbox",{attrs:{rules:[function(e){return!!e||"You must agree to continue!"}],label:"Do you agree?",required:""},model:{value:e.checkbox,callback:function(t){e.checkbox=t},expression:"checkbox"}}),s("v-btn",{staticClass:"btn mr-4",attrs:{disabled:!e.valid,color:"success"},on:{click:e.auth}},[e._v(" Enter chat ")]),s("v-btn",{staticClass:"btn mr-4",attrs:{color:"error"},on:{click:e.reset}},[e._v(" Reset Form ")])],1)],1)],1)},ne=[],re=(s("c975"),{name:"Login",components:{},data:function(){return{valid:!0,userInfo:{name:"Andrew"},nameRules:[function(e){return!!e||"Name is required"},function(e){return e&&e.length<=20||"Name must be less than 20 characters"},function(e){return(e||"").indexOf(" ")<0||"No spaces are allowed"},function(e){return/^[a-zA-Z0-9_-]+$/.test(e)||"Only english letters"}],checkbox:!0}},computed:Object(o["a"])({},Object(i["d"])("storage",["userDetails"])),methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])("storage",["authUser","logoutUser"])),{},{auth:function(){this.authUser(this.userInfo)},logout:function(){this.logoutUser()},reset:function(){this.$refs.form.reset()}})}),oe=re,ie=(s("3b75"),s("ac7c")),ce=s("4bd4"),ue=s("8654"),le=Object(f["a"])(oe,ae,ne,!1,null,"b94a4832",null),de=le.exports;m()(le,{VApp:h["a"],VAppBar:Y["a"],VBtn:N["a"],VCheckbox:ie["a"],VForm:ce["a"],VMain:K["a"],VSpacer:X["a"],VTextField:ue["a"],VToolbarTitle:ee["a"]}),a["a"].use(w["a"]);var fe=[{path:"/",name:"Chat",component:se},{path:"/auth",name:"Auth",component:de}],pe=new w["a"]({mode:"history",base:"/",routes:fe}),me=pe,he=(s("99af"),s("b0c0"),{userDetails:{},users:{},messages:{}}),ge={setUserDetails:function(e,t){console.log("setUserDetails"),e.userDetails=t},addUser:function(e,t){console.log("addUser"),a["a"].set(e.users,t.userId,t.userDetails)},updateUser:function(e,t){console.log("updateUser"),Object.assign(e.users[t.userId],t.userDetails)},addMessage:function(e,t){console.log("addMessage"),a["a"].set(e.messages,t.messageId,t.messageDetails)}},be={authUser:function(e,t){var s=new u.a.auth.GoogleAuthProvider;s.addScope("https://www.googleapis.com/auth/contacts.readonly"),u.a.auth().signInWithPopup(s).then((function(){var e=u.a.auth().currentUser.uid;je.ref("users/"+e).set({name:t.name,email:u.a.auth().currentUser.email,online:!0})})).catch((function(e){console.error(e)}))},logoutUser:function(){u.a.auth().signOut()},handleAuthStateChanged:function(e){var t=e.commit,s=e.dispatch,a=e.state;u.a.auth().onAuthStateChanged((function(e){if(e){var n=u.a.auth().currentUser.uid;je.ref("users/"+n).once("value",(function(e){var s=e.val();t("setUserDetails",{name:s.name,email:s.email,userId:n})})),s("firebaseUpdateUser",{userId:n,updates:{online:!0}}),s("firebaseGetUsers")}else s("firebaseUpdateUser",{userId:a.userDetails.userId,updates:{online:!1}}),t("setUserDetails",{})}))},firebaseUpdateUser:function(e,t){t.userId&&je.ref("users/"+t.userId).update(t.updates)},firebaseGetUsers:function(e){var t=e.commit;je.ref("users").on("child_added",(function(e){var s=e.val(),a=e.key;t("addUser",{userId:a,userDetails:s})})),je.ref("users").on("child_changed",(function(e){var s=e.val(),a=e.key;t("updateUser",{userId:a,userDetails:s})}))},firebaseGetMessages:function(e){var t=e.commit;u.a.database().ref("chat").on("child_added",(function(e){var s=e.val(),a=e.key;t("addMessage",{messageId:a,messageDetails:s})}))},firebaseSendMessage:function(e,t){var s=he.userDetails.userId,a=t.createdAt.getMilliseconds(),n=t.createdAt.getHours(),r=t.createdAt.getMinutes();je.ref("chat").push({message:t.newMessage,key:a,createdAt:"".concat(n,":").concat(r),id:s,from:he.userDetails.name,email:he.userDetails.email})}},ve={users:function(e){return e.users}},_e={namespaced:!0,state:he,mutations:ge,actions:be,getters:ve};a["a"].use(i["a"]);var we=new i["a"].Store({modules:{storage:_e}}),xe=we;s("e71f");var ye={apiKey:"AIzaSyA6DxHECxq5JENko95YbeUJH6ZLoQc8yjQ",authDomain:"simplex-ced4e.firebaseapp.com",databaseURL:"https://simplex-ced4e.firebaseio.com",projectId:"simplex-ced4e",storageBucket:"simplex-ced4e.appspot.com",messagingSenderId:"899938723722",appId:"1:899938723722:web:a5843e4ee7eccad8c78a73"};u.a.initializeApp(ye);var Oe=u.a.database();a["a"].config.productionTip=!1,new a["a"]({vuetify:_,router:me,store:xe,render:function(e){return e(b)}}).$mount("#app");var je=t["default"]=Oe},"715a":function(e,t,s){},8369:function(e,t,s){},"85ec":function(e,t,s){},bf62:function(e,t,s){"use strict";var a=s("1a84"),n=s.n(a);n.a},c0d3:function(e,t,s){"use strict";var a=s("8369"),n=s.n(a);n.a}});
//# sourceMappingURL=app.5caa5587.js.map