(function(e){function t(t){for(var s,o,i=t[0],c=t[1],u=t[2],d=0,f=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&f.push(n[o][0]),n[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);l&&l(t);while(f.length)f.shift()();return r.push.apply(r,u||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],s=!0,i=1;i<a.length;i++){var c=a[i];0!==n[c]&&(s=!1)}s&&(r.splice(t--,1),e=o(o.s=a[0]))}return e}var s={},n={app:0},r=[];function o(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=s,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(a,s,function(t){return e[t]}.bind(null,s));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var s=a("85ec"),n=a.n(s);n.a},1461:function(e,t,a){"use strict";var s=a("de1b"),n=a.n(s);n.a},1493:function(e,t,a){"use strict";var s=a("e312"),n=a.n(s);n.a},"16a0":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",{attrs:{id:"app"}},[a("router-view")],1)},r=[],o=(a("ac1f"),a("5319"),a("5530")),i=a("2f62"),c=a("8aa5"),u=a.n(c),l={methods:Object(o["a"])({},Object(i["b"])("storage",["handleAuthStateChanged"])),mounted:function(){var e=this;this.handleAuthStateChanged(),u.a.auth().onAuthStateChanged((function(t){t?e.$router.replace("/").catch((function(){})):e.$router.replace("/auth").catch((function(){}))}))}},d=l,f=(a("034f"),a("2877")),p=a("6544"),m=a.n(p),h=a("7496"),g=Object(f["a"])(d,n,r,!1,null,null,null),b=g.exports;m()(g,{VApp:h["a"]});var v=a("f309");s["a"].use(v["a"]);var _=new v["a"]({}),w=a("8c4f"),x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",{attrs:{id:"chat"}},[a("v-navigation-drawer",{attrs:{app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("display-users")],1),a("v-app-bar",{attrs:{app:"",color:"indigo",dark:""}},[a("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),a("v-toolbar-title",[e._v("Simplex Chat")]),a("v-spacer"),e.userDetails.userId?a("v-btn",{staticClass:"btn mr-4 white--text v-btn--outlined",attrs:{color:"indigo"},on:{click:e.logout}},[a("div",{staticClass:"btn__text"},[e._v(" Logout"),a("br"),a("p",{staticClass:"btn__text-username mb-0"},[e._v(e._s(e.userDetails.name))])])]):e._e()],1),a("v-main",[a("show-messages"),a("send-messages")],1),a("v-footer",{attrs:{color:"indigo",app:""}},[a("span",{staticClass:"white--text"},[e._v('Â© "Simplex", '+e._s((new Date).getFullYear()))])])],1)},y=[],O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"display-users"}},e._l(e.users,(function(t,s){return a("v-list",{key:s,staticClass:"users-list pb-0",attrs:{dense:""}},[a("v-list-item",{staticClass:"users-list__item"},[a("span",{staticClass:"users-list__avatar"},[e._v(e._s(t.name.charAt(0)))]),e._v(" "+e._s(t.name)+" "),a("span",{staticClass:"users-list__text text",class:t.online?"online":"offline"},[e.userDetails.email===t.email?a("v-icon",{staticClass:"users-list__you mr-1"},[e._v("mdi-account-check-outline")]):e._e(),e._v(" "+e._s(t.online?"Online":"Offline")+" ")],1)])],1)})),1)},j=[],k={name:"DisplayUsers",data:function(){return{}},computed:Object(o["a"])(Object(o["a"])({},Object(i["d"])("storage",["userDetails"])),Object(i["c"])("storage",["users"]))},C=k,M=(a("bdfc"),a("132d")),D=a("8860"),I=a("da13"),U=Object(f["a"])(C,O,j,!1,null,"154760b6",null),S=U.exports;m()(U,{VIcon:M["a"],VList:D["a"],VListItem:I["a"]});var V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"chat",staticClass:"chat",attrs:{id:"show-messages"}},e._l(e.messages,(function(t,s){return a("v-list",{key:s,staticClass:"chat__list",class:{owner:t.id===e.userDetails.userId}},[a("v-list-item",{staticClass:"chat__item theme--dark",class:{hidden:!e.showMessages},on:{click:e.showTime}},[a("span",{staticClass:"chat__time",class:{"your-time":t.id===e.userDetails.userId}},[e._v(" "+e._s(t.createdAt)+" ")]),a("span",{staticClass:"chat__nickname font-weight-bold"},[e._v(e._s(t.from))]),e._v(": "+e._s(t.message)+" ")])],1)})),1)},A=[],T=(a("b64b"),{name:"ShowMessages",data:function(){return{showMessages:!1}},computed:Object(o["a"])({},Object(i["d"])("storage",["userDetails","messages"])),methods:{scrollToBottom:function(){var e=this,t=this.$refs.chat;setTimeout((function(){t.scrollTo(0,t.scrollHeight)}),20),setTimeout((function(){e.showMessages=!0}),1e3)},showTime:function(){}},watch:{messages:function(e){Object.keys(e).length&&this.scrollToBottom()}},mounted:function(){this.scrollToBottom()}}),$=T,P=(a("9689"),Object(f["a"])($,V,A,!1,null,"4e06ec4a",null)),B=P.exports;m()(P,{VList:D["a"],VListItem:I["a"]});var E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"actions",attrs:{id:"send-messages"}},[a("v-textarea",{ref:"textField",attrs:{placeholder:"Type your message...",autofocus:"",autocomplete:"false","no-resize":""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMessage(t)}},model:{value:e.message.newMessage,callback:function(t){e.$set(e.message,"newMessage","string"===typeof t?t.trim():t)},expression:"message.newMessage"}}),a("v-btn",{staticClass:"btn mr-4",attrs:{color:"success",disabled:0===e.message.newMessage.length},on:{click:e.sendMessage}},[a("span",{staticClass:"btn-span"},[e._v("Send")])])],1)},L=[],F={name:"SendMessages",data:function(){return{message:{newMessage:"",createdAt:new Date}}},methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])("storage",["firebaseSendMessage","firebaseGetMessages"])),{},{sendMessage:function(){0!==this.message.newMessage.length&&(this.firebaseSendMessage(this.message),this.firebaseGetMessages(),this.clearMessage())},clearMessage:function(){this.message.newMessage="",this.$refs.textField.focus()}}),mounted:function(){this.firebaseGetMessages()}},G=F,N=(a("1461"),a("8336")),q=a("a844"),z=Object(f["a"])(G,E,L,!1,null,"40a7770c",null),H=z.exports;m()(z,{VBtn:N["a"],VTextarea:q["a"]});var J={name:"Chat",components:{DisplayUsers:S,ShowMessages:B,SendMessages:H},data:function(){return{drawer:null}},computed:Object(o["a"])({},Object(i["d"])("storage",["userDetails"])),methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])("storage",["logoutUser"])),{},{logout:function(){this.logoutUser()}})},R=J,Y=a("40dc"),Q=a("5bc1"),Z=a("553a"),K=a("f6c4"),W=a("f774"),X=a("2fa4"),ee=a("2a7f"),te=Object(f["a"])(R,x,y,!1,null,"085b72f0",null),ae=te.exports;m()(te,{VApp:h["a"],VAppBar:Y["a"],VAppBarNavIcon:Q["a"],VBtn:N["a"],VFooter:Z["a"],VMain:K["a"],VNavigationDrawer:W["a"],VSpacer:X["a"],VToolbarTitle:ee["a"]});var se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",{attrs:{id:"reg-form"}},[a("v-app-bar",{attrs:{app:"",color:"indigo",dark:""}},[a("v-toolbar-title",[e._v("Simplex Chat")]),a("v-spacer"),e.userDetails.userId?a("v-btn",{staticClass:"btn mr-4 white--text v-btn--outlined",attrs:{color:"indigo"},on:{click:e.logout}},[a("div",{staticClass:"btn__text"},[e._v(" Logout"),a("br"),a("p",{staticClass:"btn__text-username mb-0"},[e._v(e._s(e.userDetails.name))])])]):e._e()],1),a("v-main",[a("v-form",{ref:"form",staticClass:"auth",attrs:{method:"get"},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("h1",{staticClass:"login-title text-lg-center"},[e._v("Please login")]),a("v-text-field",{staticClass:"validate mt-2",attrs:{counter:20,rules:e.nameRules,label:"Name",type:"text",name:"name",required:""},model:{value:e.userInfo.name,callback:function(t){e.$set(e.userInfo,"name",t)},expression:"userInfo.name"}}),a("v-checkbox",{attrs:{rules:[function(e){return!!e||"You must agree to continue!"}],label:"Do you agree?",required:""},model:{value:e.checkbox,callback:function(t){e.checkbox=t},expression:"checkbox"}}),a("v-btn",{staticClass:"btn mr-4",attrs:{disabled:!e.valid,color:"success"},on:{click:e.auth}},[e._v(" Enter chat ")]),a("v-btn",{staticClass:"btn mr-4",attrs:{color:"error"},on:{click:e.reset}},[e._v(" Reset Form ")])],1)],1)],1)},ne=[],re=(a("c975"),{name:"Login",components:{},data:function(){return{valid:!0,userInfo:{name:""},nameRules:[function(e){return!!e||"Name is required"},function(e){return e&&e.length<=20||"Name must be less than 20 characters"},function(e){return(e||"").indexOf(" ")<0||"No spaces are allowed"},function(e){return/^[a-zA-Z0-9_-]+$/.test(e)||"Only english letters"}],checkbox:!1}},computed:Object(o["a"])({},Object(i["d"])("storage",["userDetails"])),methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])("storage",["authUser","logoutUser"])),{},{auth:function(){this.authUser(this.userInfo)},logout:function(){this.logoutUser()},reset:function(){this.$refs.form.reset()}})}),oe=re,ie=(a("1493"),a("ac7c")),ce=a("4bd4"),ue=a("8654"),le=Object(f["a"])(oe,se,ne,!1,null,"b42c00fe",null),de=le.exports;m()(le,{VApp:h["a"],VAppBar:Y["a"],VBtn:N["a"],VCheckbox:ie["a"],VForm:ce["a"],VMain:K["a"],VSpacer:X["a"],VTextField:ue["a"],VToolbarTitle:ee["a"]}),s["a"].use(w["a"]);var fe=[{path:"/",name:"Chat",component:ae},{path:"/auth",name:"Auth",component:de}],pe=new w["a"]({mode:"history",base:"/",routes:fe}),me=pe,he=(a("99af"),a("a15b"),a("b0c0"),a("d3b7"),a("25f0"),{userDetails:{},users:{},messages:{}}),ge={setUserDetails:function(e,t){e.userDetails=t},addUser:function(e,t){s["a"].set(e.users,t.userId,t.userDetails)},updateUser:function(e,t){Object.assign(e.users[t.userId],t.userDetails)},addMessage:function(e,t){s["a"].set(e.messages,t.messageId,t.messageDetails)}},be={authUser:function(e,t){var a=new u.a.auth.GoogleAuthProvider;a.addScope("https://www.googleapis.com/auth/contacts.readonly"),u.a.auth().signInWithPopup(a).then((function(){var e=u.a.auth().currentUser.uid;je.ref("users/"+e).set({name:t.name,email:u.a.auth().currentUser.email,online:!0})})).catch((function(e){console.error(e)}))},logoutUser:function(){u.a.auth().signOut()},handleAuthStateChanged:function(e){var t=e.commit,a=e.dispatch,s=e.state;u.a.auth().onAuthStateChanged((function(e){if(e){var n=u.a.auth().currentUser.uid;je.ref("users/"+n).once("value",(function(e){var a=e.val();t("setUserDetails",{name:a.name,email:a.email,userId:n})})),a("firebaseUpdateUser",{userId:n,updates:{online:!0}}),a("firebaseGetUsers")}else a("firebaseUpdateUser",{userId:s.userDetails.userId,updates:{online:!1}}),t("setUserDetails",{})}))},firebaseUpdateUser:function(e,t){t.userId&&je.ref("users/"+t.userId).update(t.updates)},firebaseGetUsers:function(e){var t=e.commit;je.ref("users").on("child_added",(function(e){var a=e.val(),s=e.key;t("addUser",{userId:s,userDetails:a})})),je.ref("users").on("child_changed",(function(e){var a=e.val(),s=e.key;t("updateUser",{userId:s,userDetails:a})}))},firebaseGetMessages:function(e){var t=e.commit;u.a.database().ref("chat").on("child_added",(function(e){var a=e.val(),s=e.key;t("addMessage",{messageId:s,messageDetails:a})}))},firebaseSendMessage:function(e,t){var a=2,s=he.userDetails.userId,n=t.createdAt.getHours(),r=t.createdAt.getMinutes().toString(),o=a>=r.length?Array.apply(null,{length:a-r.length+1}).join("0")+r:r.substring(0,a);je.ref("chat").push({message:t.newMessage,createdAt:"".concat(n,":").concat(o),id:s,from:he.userDetails.name,email:he.userDetails.email})}},ve={users:function(e){return e.users}},_e={namespaced:!0,state:he,mutations:ge,actions:be,getters:ve};s["a"].use(i["a"]);var we=new i["a"].Store({modules:{storage:_e}}),xe=we;a("e71f");var ye={apiKey:"AIzaSyA6DxHECxq5JENko95YbeUJH6ZLoQc8yjQ",authDomain:"simplex-ced4e.firebaseapp.com",databaseURL:"https://simplex-ced4e.firebaseio.com",projectId:"simplex-ced4e",storageBucket:"simplex-ced4e.appspot.com",messagingSenderId:"899938723722",appId:"1:899938723722:web:a5843e4ee7eccad8c78a73"};u.a.initializeApp(ye);var Oe=u.a.database();s["a"].config.productionTip=!1,new s["a"]({vuetify:_,router:me,store:xe,render:function(e){return e(b)}}).$mount("#app");var je=t["default"]=Oe},"85ec":function(e,t,a){},9689:function(e,t,a){"use strict";var s=a("16a0"),n=a.n(s);n.a},bdfc:function(e,t,a){"use strict";var s=a("ff6a"),n=a.n(s);n.a},de1b:function(e,t,a){},e312:function(e,t,a){},ff6a:function(e,t,a){}});
//# sourceMappingURL=app.b5df3c1c.js.map